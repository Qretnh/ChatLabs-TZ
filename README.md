# ChatLabs-TZ

<h1>стек</h1>

Бэкенд: django + DRF

<h1>Запуск проекта</h1>
docker-compose up

основные данные для запуска уже лежат в .env, НУЖЕН ТОЛЬКО токен для бота, остальное вписано в .env.example

<h1>Краткое описание архитектуры решения</h1>

<h2>Бэкенд</h2>

Папка - backend

Приложение django + DRF

базовое приложение в папке backend/backend

Работает с БД postgres, в models базовые модели, вместо PK у них HashidAutoField

из базового приложения запускается celery + celery beat. Celery шлёт уведомления о дате истечения тасок

приложение ToDo - в папке TODO. В нём описаны основные модели, сериалайзеры и представления. в папке backend/TODO/services лежит код для отправки уведомлений через Celery.

Бэкенд общается с ботом через REST API, бот посылает запросы контейнеру джанги через httpx

Таймзона - America/Adak

свой докерфайл в директории

<h2>Бот</h2>

папка - bot

aiogram + aiogram_dialog

handlers - обработчики aiogram (только старт, остальное диалоги)

dialogs - aiogram_dialog, основные диалоги. геттеры, функции, само окно диалога разбито на разные файлы.

сервисный код для работы с django лежит в bot/services/api разделённый по моделям (таски, категории, юзеры). через httpx запросы идут к DRF, после идут в диалоги.

свой докерфайл в директории

Функционал бота - Добавление, изменение задач, просмотр задач, архив задач для сделанных и удаление для ненужных. У тасок показано время создания

Просмотр и создание категорий тасок. 

<h2>Проект</h2>

В проекте 6 сервисов

postgres - база данных для бэка
django - бэк и DRF
bot - бот aiogram + aiogram_dialog
redis - KV хранилище для Celery
celery - уведомления о времени исполнения тасок
celery-beat - ежеминутное сообщение в селери о необходимости проверить, нет ли тасок на которые нужно уведомление

в компоузе указан авторестарт, запуск приложения через него.

Для удобства, все данные Postgres из контейнера привязаны к папке pg_data в корневой директории. При перезапуске контейнера или компоуза данные НЕ пропадают.

<h1>С какими проблемами столкнулся и как решил</h1>

1. Ограничения на PK. Обычно использовал те, которые находились в ограничении. Погуглил и изучил информацию чтобы найти альтернативу.

2. Проектирование заметок. Из ТЗ была неясна архитектура (структура) самого TO-DO, нужно было продумать функционал, навигацию и то, какие возможности следует зашить в приложение. Сложным было продумывание UI. Решил так - сперва шёл от требований, после реализации базовых требований добавлял удобства и фичи в интерфейс, которые казались нужными. так же спрашивал у DeepSeek и ChatGPT как лучше спроектировать интерфейс и присылал свои идеи им, просил дать советы что можно улучшить в моём решении.

3. Структура проекта. Из-за довольно большого количества сервисов, было сложно продумать чистую структур приложения. Решение: Изучил структуры похожих приложений на GitHub, после того как завершил этап работы над функционалом - сел рефакторить код и его структуру. Местами спрашивал GPT как можно сделать структуру более прозрачной и понятной
